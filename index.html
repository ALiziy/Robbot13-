<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ماشین حساب کسرها</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }
        
        .fraction-input {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .fraction-part {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px;
        }
        
        .fraction-part input {
            width: 60px;
            height: 40px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 18px;
            margin: 2px 0;
        }
        
        .fraction-line {
            width: 60px;
            height: 2px;
            background-color: #333;
            margin: 5px 0;
        }
        
        .operation {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        .operation button {
            width: 50px;
            height: 50px;
            font-size: 24px;
            border: none;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            margin: 0 10px;
            transition: background-color 0.3s;
        }
        
        .operation button:hover {
            background-color: #2980b9;
        }
        
        .calculate-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        
        .calculate-btn:hover {
            background-color: #27ae60;
        }
        
        .result {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            text-align: center;
            font-size: 20px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .result-fraction {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px 0;
        }
        
        .simplified {
            margin-top: 15px;
            font-size: 16px;
            color: #7f8c8d;
        }
        
        .steps {
            margin-top: 20px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        @media (max-width: 500px) {
            .fraction-input {
                justify-content: center;
            }
            
            .fraction-part input {
                width: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ماشین حساب جمع و تفریق کسرها</h1>
        
        <div class="fraction-input">
            <div class="fraction-part">
                <input type="number" id="num1" placeholder="صورت">
                <div class="fraction-line"></div>
                <input type="number" id="den1" placeholder="مخرج">
            </div>
            
            <div class="operation">
                <button id="add-btn">+</button>
                <button id="subtract-btn">-</button>
            </div>
            
            <div class="fraction-part">
                <input type="number" id="num2" placeholder="صورت">
                <div class="fraction-line"></div>
                <input type="number" id="den2" placeholder="مخرج">
            </div>
        </div>
        
        <button class="calculate-btn" id="calculate">محاسبه</button>
        
        <div class="result" id="result">
            نتیجه اینجا نمایش داده می‌شود
        </div>
        
        <div class="steps" id="steps">
            مراحل محاسبه اینجا نمایش داده می‌شود
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const num1Input = document.getElementById('num1');
            const den1Input = document.getElementById('den1');
            const num2Input = document.getElementById('num2');
            const den2Input = document.getElementById('den2');
            const addBtn = document.getElementById('add-btn');
            const subtractBtn = document.getElementById('subtract-btn');
            const calculateBtn = document.getElementById('calculate');
            const resultDiv = document.getElementById('result');
            const stepsDiv = document.getElementById('steps');
            
            let operation = '+';
            
            addBtn.addEventListener('click', function() {
                operation = '+';
                addBtn.style.backgroundColor = '#2980b9';
                subtractBtn.style.backgroundColor = '#3498db';
            });
            
            subtractBtn.addEventListener('click', function() {
                operation = '-';
                subtractBtn.style.backgroundColor = '#2980b9';
                addBtn.style.backgroundColor = '#3498db';
            });
            
            addBtn.style.backgroundColor = '#2980b9';
            
            calculateBtn.addEventListener('click', function() {
                const num1 = parseInt(num1Input.value) || 0;
                const den1 = parseInt(den1Input.value) || 1;
                const num2 = parseInt(num2Input.value) || 0;
                const den2 = parseInt(den2Input.value) || 1;
                
                if (den1 === 0 || den2 === 0) {
                    resultDiv.innerHTML = '<div style="color: red;">خطا: مخرج نمی‌تواند صفر باشد</div>';
                    stepsDiv.innerHTML = '';
                    return;
                }
                
                const result = calculateFractions(num1, den1, num2, den2, operation);
                displayResult(result);
            });
            
            function calculateFractions(num1, den1, num2, den2, op) {
                let steps = [];
                
                steps.push(`کسر اول: ${num1}/${den1}`);
                steps.push(`کسر دوم: ${num2}/${den2}`);
                steps.push(`عملیات: ${op === '+' ? 'جمع' : 'تفریق'}`);
                
                const lcm = findLCM(den1, den2);
                steps.push(`کوچکترین مضرب مشترک مخرج‌ها: ${lcm}`);
                
                const newNum1 = num1 * (lcm / den1);
                const newNum2 = num2 * (lcm / den2);
                steps.push(`تبدیل کسر اول: ${num1}/${den1} = ${newNum1}/${lcm}`);
                steps.push(`تبدیل کسر دوم: ${num2}/${den2} = ${newNum2}/${lcm}`);
                
                let resultNum;
                if (op === '+') {
                    resultNum = newNum1 + newNum2;
                    steps.push(`جمع صورت‌ها: ${newNum1} + ${newNum2} = ${resultNum}`);
                } else {
                    resultNum = newNum1 - newNum2;
                    steps.push(`تفریق صورت‌ها: ${newNum1} - ${newNum2} = ${resultNum}`);
                }
                
                steps.push(`نتیجه اولیه: ${resultNum}/${lcm}`);
                
                const gcd = findGCD(resultNum, lcm);
                const simplifiedNum = resultNum / gcd;
                const simplifiedDen = lcm / gcd;
                
                if (gcd > 1) {
                    steps.push(`بزرگترین مقسوم‌علیه مشترک: ${gcd}`);
                    steps.push(`ساده کردن: ${resultNum}/${lcm} = ${simplifiedNum}/${simplifiedDen}`);
                } else {
                    steps.push(`کسر قبلاً ساده شده است`);
                }
                
                return {
                    numerator: resultNum,
                    denominator: lcm,
                    simplifiedNumerator: simplifiedNum,
                    simplifiedDenominator: simplifiedDen,
                    steps: steps
                };
            }
            
            function displayResult(result) {
                let resultHTML = '';
                
                if (result.numerator === 0) {
                    resultHTML = '<div>نتیجه: 0</div>';
                } else if (result.denominator === 1) {
                    resultHTML = `<div>نتیجه: ${result.numerator}</div>`;
                } else {
                    resultHTML = `
                        <div class="result-fraction">
                            <div>${result.numerator}</div>
                            <div class="fraction-line" style="width: 80px;"></div>
                            <div>${result.denominator}</div>
                        </div>
                    `;
                    
                    if (result.numerator !== result.simplifiedNumerator) {
                        resultHTML += `
                            <div class="simplified">
                                شکل ساده شده:
                                <div class="result-fraction">
                                    <div>${result.simplifiedNumerator}</div>
                                    <div class="fraction-line" style="width: 60px;"></div>
                                    <div>${result.simplifiedDenominator}</div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                resultDiv.innerHTML = resultHTML;
                
                let stepsHTML = '<h3>مراحل محاسبه:</h3><ol>';
                result.steps.forEach(step => {
                    stepsHTML += `<li>${step}</li>`;
                });
                stepsHTML += '</ol>';
                
                stepsDiv.innerHTML = stepsHTML;
            }
            
            function findGCD(a, b) {
                a = Math.abs(a);
                b = Math.abs(b);
                
                if (b === 0) return a;
                return findGCD(b, a % b);
            }
            
            function findLCM(a, b) {
                return Math.abs(a * b) / findGCD(a, b);
            }
        });
    </script>
</body>
</html>
